<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: puertoserial/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: puertoserial/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

var serialport = require("serialport")
var async = require("async")
var util = require('util')
var EventEmitter = require('events').EventEmitter


/**
 * var - Crea una serie Async para el manejo del puerto serie
 *
 * @return {type}  description
 */
var serial_port = function(){
  var portArduino = null
  var serialPort = null
  var data_serial = this

  async.series([portList,
                serialConf,
                serialSocket],serialFinished)

  /**
   * portList - Lista los puertos disponibles en el servidor local
   *
   * @param  {done} done secuencia Async
   * @return {type}      description
   */
  function portList(done) {
    console.log('start')

    /**
     * anonymous function - description
     *
     * @param  {err} err   Envia los errores de la conexion con el puerto serie
     * @param  {Object} ports Puertos serie disponibles en el servidor local
     * @return {type}       Puertos
     */
    serialport.list(function (err , ports){
      async.eachSeries(ports, portsLists, done)
    })
  }


  /**
   * portsLists - Serie de puertos
   *
   * @param  {type} port Puerto en especifico
   * @param  {type} done Seguidor de Secuencia Async
   * @return {type}      description
   */
  function portsLists(port, done){
    if(port.serialNumber){
        portArduino = port.comName
      }
    done()
  }

  /**
   * serialConf - Configuaracion del puerto serie para conexion
   *
   * @param  {type} done description
   * @return {type}      description
   */
  function serialConf(done) {
    console.log('ports Lists Arduino')
    if (portArduino != null){
      serialPort = new serialport.SerialPort(portArduino, {
        baudrate: 9600,
        parser: serialport.parsers.readline('\r\n')
      });
    }
    console.log(serialPort)
    done()
  }

  /**
   * serialSocket - Crea socket local para comunicaci√≥n asincrona
   *
   * @param  {type} done description
   * @return {type}      description
   */
  function serialSocket(done){
    if(portArduino != null){
        serialPort.on('data', function(data){
          data_serial.emit('data',data)
          serialPort.write('hi')
        })
    }
    done()
  }

  /**
   * serialFinished - Finalizacion de la serie
   *
   * @return {type}  description
   */
  function serialFinished() {
   console.log('done');
  }
}

util.inherits(serial_port,EventEmitter)
module.exports = serial_port
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#io">io</a></li><li><a href="global.html#ip">ip</a></li><li><a href="global.html#ipL">ipL</a></li><li><a href="global.html#net">net</a></li><li><a href="global.html#normalizeChain">normalizeChain</a></li><li><a href="global.html#serial">serial</a></li><li><a href="global.html#serial_Arduino">serial_Arduino</a></li><li><a href="global.html#serial_port">serial_port</a></li><li><a href="global.html#server_lc">server_lc</a></li><li><a href="global.html#server_local">server_local</a></li><li><a href="global.html#server_remoteIO">server_remoteIO</a></li><li><a href="global.html#serverIO">serverIO</a></li><li><a href="global.html#serverLC">serverLC</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Jul 11 2016 11:59:47 GMT-0500 (ECT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
