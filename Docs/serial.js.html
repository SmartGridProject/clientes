<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: serial.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: serial.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Este proyecto permite la comunicaci贸n por medio de sockets entre PLC - arduino
 * y plc
 * Junio de 2016.
 * Creado por Mauricio Duque
 */

/**
 * Variable para asignacion de la IP para el servidor
 */
var ip = {}

/**
 * Ip Local
 */
var ipL = require('ip')
ipL.port = 2001

/**
 * Socket con Servidor [CEDIA]
 */
var serverIO = require('./serverIO')

/**
 * Crea un socket local
 */
var serverLC = require('./serverLocal')

/**
 * Comunicaci贸n entre servidor local y PLC - Arduino
 */
var serial = require('./puertoserial')

/**
 * Normaliza la cadena para enviar en formato JSON
 */
var normalizeChain = require('./normalizer_chains')

// set the ip

/**
 *
 */
ip.address_ip = '190.15.141.74'
ip.port = '8000'
ip.protocol = 'http'
ip.address = ip.protocol + '://' + ip.address_ip + ':' + ip.port


/**
 * Inicializador del Servidor
 * @param {Object} 'ip'   datos de ip del servidor [no local]
 */
var server_remoteIO = serverIO(ip)
/**
 * Inicializador de Servidor local
 * @param {Object} 'ipL' datos de ip local
 */
var server_local = new serverLC(ipL)
/**
 * Inicializador del puerto serial, solo para Arduino
 */
var serial_Arduino = new serial()


/**
 * serial_Arduino - description
 * Permite que se conecte mediante sockets a los puertos y envial la informaci贸n
 * normalizada a servidor  [CEDIA]
 *
 * @param  {Object} 'data'        Respuesta del puerto serial
 * @param  {type} function(data description
 * @return {type}               description
 */
serial_Arduino.on('data',function(data){
  console.log(data);
  if (process.argv[2] == 'Arduino' || process.argv[2] == 'arduino') {
    //console.log(normalizeChain(data));
    //console.log(process.argv[3]);
     //server_remoteIO.emit('OMG',{dataADQ:normalizeChain(data)}) // For first lab
    server_remoteIO.emit(process.argv[3],{dataADQ:normalizeChain(data)})
    server_remoteIO.on('news', (data)=>{
      console.log(data);
    })
  }else{
    console.error('No se determina dispositivo');
  }
})



/**
 * server_local - description
 * Permite que se conecte mediante sockets a los puertos y envial la informaci贸n
 * normalizada a servidor  [CEDIA]
 * @param  {type} 'data'        description
 * @param  {type} function(data description
 * @return {type}               description
 */
server_local.on('data', function(data){
  if (process.argv[2] == 'PLC' || process.argv[2] == 'plc'){
    data.on('data',function(data){
      server_remoteIO.emit(process.argv[3],{dataADQ:normalizeChain(data)})
    })
  }else {
    console.error('No se determina dispositivo');
  }

})


// server_remoteIO.on('news', function(data){
//   console.log(data);
// })
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#io">io</a></li><li><a href="global.html#ip">ip</a></li><li><a href="global.html#ipL">ipL</a></li><li><a href="global.html#net">net</a></li><li><a href="global.html#normalizeChain">normalizeChain</a></li><li><a href="global.html#serial">serial</a></li><li><a href="global.html#serial_Arduino">serial_Arduino</a></li><li><a href="global.html#serial_port">serial_port</a></li><li><a href="global.html#server_lc">server_lc</a></li><li><a href="global.html#server_local">server_local</a></li><li><a href="global.html#server_remoteIO">server_remoteIO</a></li><li><a href="global.html#serverIO">serverIO</a></li><li><a href="global.html#serverLC">serverLC</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Jul 11 2016 11:59:47 GMT-0500 (ECT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
